var De=s=>{throw TypeError(s)};var ue=(s,e,i)=>e.has(s)||De("Cannot "+i);var t=(s,e,i)=>(ue(s,e,"read from private field"),i?i.call(s):e.get(s)),a=(s,e,i)=>e.has(s)?De("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,i),r=(s,e,i,n)=>(ue(s,e,"write to private field"),n?n.call(s,i):e.set(s,i),i),x=(s,e,i)=>(ue(s,e,"access private method"),i);var se=(s,e,i,n)=>({set _(h){r(s,e,h,i)},get _(){return t(s,e,n)}});import{r as R,j as m,B as Xe,M as Ye,A as qe}from"./index-CECLz__I.js";import"./services-D8YECjA7.js";const We=()=>[1,0,0,0,1,0,0,0,1],ie=(s,e)=>{if(typeof e=="number")return s.forEach((i,n,h)=>h[n]=i*e),s;if(e.length===3)return[s[0]*e[0]+s[1]*e[1]+s[2]*e[2],s[3]*e[0]+s[4]*e[1]+s[5]*e[2],s[6]*e[0]+s[7]*e[1]+s[8]*e[2]];if(e.length/3==3)return[s[0]*e[0]+s[1]*e[3]+s[2]*e[6],s[0]*e[1]+s[1]*e[4]+s[2]*e[7],s[0]*e[2]+s[1]*e[5]+s[2]*e[8],s[3]*e[0]+s[4]*e[3]+s[5]*e[6],s[3]*e[1]+s[4]*e[4]+s[5]*e[7],s[3]*e[2]+s[4]*e[5]+s[5]*e[8],s[6]*e[0]+s[7]*e[3]+s[8]*e[6],s[6]*e[1]+s[7]*e[4]+s[8]*e[7],s[6]*e[2]+s[7]*e[5]+s[8]*e[8]];throw"Invalid array length."},re=(s,e)=>{if(e.length%3==0){let[i,n,h,d]=[0,0,0,0];const b=e.length/3;for(let O=0;O<b;O++)d=3*O,[i,n,h]=[e[0+d],e[1+d],e[2+d]],e[0+d]=s[0]*i+s[1]*n+s[2]*h,e[1+d]=s[3]*i+s[4]*n+s[5]*h,e[2+d]=s[6]*i+s[7]*n+s[8]*h}else throw"Invalid array length."};function _e(s){s=Math.abs(parseInt(s));const e=Math.floor(s/36e5),i=Math.floor(s%36e5/6e4),n=Math.floor(s%6e4/1e3),h=s%1e3;return`${e}h ${i}m ${n}s ${h}ms`}var X,Y;class Ge{constructor(){a(this,X,0);a(this,Y,0)}step(e){return r(this,X,t(this,X)+e),r(this,Y,t(this,Y)+1),this}get(){return t(this,X)/t(this,Y)}}X=new WeakMap,Y=new WeakMap;var q;class Ee{constructor(){a(this,q,!1)}frame(e,i){throw"TODO Override!"}render(e,i){return this.frame(e,i),!t(this,q)}remove(){r(this,q,!0)}}q=new WeakMap;var W,_,H;class Me{constructor(e,i,n){a(this,W);a(this,_);a(this,H);r(this,W,e),r(this,_,i),r(this,H,n)}getVerts(){return Array.from(t(this,W))}getEdges(){return Array.from(t(this,_))}getFaces(){return Array.from(t(this,H))}}W=new WeakMap,_=new WeakMap,H=new WeakMap;var J,I,$,ne,k,z;class He extends Ee{constructor(i,n,h,d,b){super();a(this,J);a(this,I);a(this,$);a(this,ne);a(this,k,"30px Tiny5");a(this,z,"black");r(this,J,typeof i=="function"?i:()=>i),r(this,I,n),r(this,$,h),r(this,k,d!==void 0?d:t(this,k)),r(this,z,b!==void 0?b:t(this,z))}frame(i,n){n.drawUiText(t(this,J).call(this),t(this,I),t(this,$),t(this,k),t(this,z))}setPosition(i,n,h){return[se(this,I)._,se(this,$)._,se(this,ne)._]=[i,n,h],this}}J=new WeakMap,I=new WeakMap,$=new WeakMap,ne=new WeakMap,k=new WeakMap,z=new WeakMap;const Te=(s,e,i,n,h)=>new He(s,e,i,n,h),Je=2*Math.PI;var f,o,N,E,M,Q,y,T,C,w,V,K,L,Z,S,F,D,B,P,v,G,j,c,fe,Ce,Ve,U,Fe,me,Pe;class Qe{constructor(e=null){a(this,c);a(this,f);a(this,o);a(this,N);a(this,E);a(this,M);a(this,Q);a(this,y);a(this,T);a(this,C,!0);a(this,w);a(this,V);a(this,K);a(this,L);a(this,Z);a(this,S);a(this,F);a(this,D);a(this,B);a(this,P);a(this,v);a(this,G);a(this,j);r(this,f,e),r(this,o,t(this,f).getContext("2d")),x(this,c,fe).call(this)}start(){return console.log("Start render engine."),r(this,E,!0),r(this,w,new Ge),r(this,S,0),r(this,T,performance.now()),t(this,C)&&this.showFpsDebug(),requestAnimationFrame(this.frame.bind(this)),this}pause(){return console.log("Pause render engine."),r(this,E,!1),this}stop(){return console.log("Stop render engine."),r(this,M,!0),this}frame(e){r(this,y,e-t(this,T)),r(this,T,e),t(this,C)&&x(this,c,Fe).call(this),x(this,c,Ve).call(this),x(this,c,Ce).call(this),t(this,E)&&t(this,M)===!1?requestAnimationFrame(this.frame.bind(this)):(t(this,C)&&x(this,c,Pe).call(this),t(this,M)!==!1&&x(this,c,fe).call(this))}moveCameraTo(e){t(this,v)[2]=e[0],t(this,v)[5]=e[1],x(this,c,U).call(this)}translateCameraBy(e){r(this,v,ie(t(this,v),[1,0,-e[0],0,1,-e[1],0,0,e[2]])),x(this,c,U).call(this)}getCameraMat(){return t(this,v)}getCanvasMat(){return t(this,G)}getViewportSize(){return[t(this,f).width,t(this,f).height]}getCanvasSize(){return[t(this,f).width,t(this,f).height]}render(e){return typeof e=="object"&&typeof e.render!==void 0&&typeof e.render=="function"?t(this,N).push(e.render.bind(e)):typeof e=="function"&&t(this,N).push(e),this}drawExample(){this.render(new Ze)}drawMesh(e){const i=e.getVerts();re(t(this,j),i),t(this,o).beginPath(),t(this,o).moveTo(i[0],i[1]);const n=i.length/3;for(let h=1;h<n;h++)t(this,o).lineTo(i[0+3*h],i[1+3*h]);t(this,o).closePath(),t(this,o).fillStyle="blue",t(this,o).fill(),t(this,o).strokeStyle="black",t(this,o).stroke()}drawUiText(e,i,n,h,d){[i,n]=ie(t(this,G),[i,n,1]),t(this,o).font=h,t(this,o).fillStyle=d,t(this,o).fillText(e,i,n)}drawPoints(e){const i=e.getVerts();re(t(this,j),i);const n=i.length/3;for(let h=0;h<n;h++)t(this,o).beginPath(),t(this,o).arc(i[0+3*h],i[1+3*h],1,0,Je),t(this,o).stroke()}drawVector(e){const i=Array.from(e);re(t(this,j),i);const n=ie(t(this,j),[0,0,1]),h=i.length/3;for(let d=0;d<h;d++)t(this,o).beginPath(),t(this,o).moveTo(n[0],n[1]),t(this,o).lineTo(i[0+3*d],i[1+3*d]),t(this,o).closePath(),t(this,o).stroke()}onResize(e,i){t(this,f).width=e,t(this,f).height=i,r(this,G,[1,0,0,0,-1,t(this,f).height,0,0,1]),x(this,c,U).call(this),t(this,C)&&this.showFpsDebug()}showFpsDebug(e,i,n){this.hideFpsDebug(),this.fpsDebugTextBox=Te((()=>`FPS: ${t(this,P)}`).bind(this),t(this,f).width-125,15),this.render(this.fpsDebugTextBox)}hideFpsDebug(){this.fpsDebugTextBox!==void 0&&this.fpsDebugTextBox.remove()}}f=new WeakMap,o=new WeakMap,N=new WeakMap,E=new WeakMap,M=new WeakMap,Q=new WeakMap,y=new WeakMap,T=new WeakMap,C=new WeakMap,w=new WeakMap,V=new WeakMap,K=new WeakMap,L=new WeakMap,Z=new WeakMap,S=new WeakMap,F=new WeakMap,D=new WeakMap,B=new WeakMap,P=new WeakMap,v=new WeakMap,G=new WeakMap,j=new WeakMap,c=new WeakSet,fe=function(){r(this,N,[]),r(this,E,!1),r(this,M,!1),r(this,Q,"rgb(255, 255, 255)"),r(this,y,0),r(this,T,0),r(this,w,null),r(this,K,0),r(this,L,0),r(this,V,0),r(this,Z,6e4),r(this,S,0),r(this,F,0),r(this,D,0),r(this,B,5e3),r(this,P,0),r(this,v,We()),r(this,G,[1,0,0,0,-1,t(this,f).height,0,0,1]),x(this,c,U).call(this)},Ce=function(){const e=t(this,N);r(this,N,[]);let i=null;for(;i=e.shift();)i(t(this,y),this)===!0&&t(this,N).push(i);return this},Ve=function(){return t(this,o).fillStyle=t(this,Q),t(this,o).fillRect(0,0,t(this,f).width,t(this,f).height),this},U=function(){r(this,j,ie(t(this,G),t(this,v)))},Fe=function(){r(this,K,t(this,K)+t(this,y)),r(this,L,t(this,L)+1),t(this,w).step(t(this,y)),x(this,c,me).call(this),t(this,S)>t(this,Z)?(r(this,V,parseInt(t(this,w).get())),r(this,S,0),r(this,w,new Ge),console.log(`Average delta: ${t(this,V)} ms`)):r(this,S,t(this,S)+t(this,y))},me=function(){t(this,D)>t(this,B)?(r(this,P,parseInt(t(this,F)/t(this,D)*1e3)),r(this,F,0),r(this,D,0),console.log("FPS:",t(this,P))):(r(this,F,t(this,F)+1),r(this,D,t(this,D)+t(this,y)))},Pe=function(){x(this,c,me).call(this),console.log(`Average delta: ${t(this,V)} ms`),console.log(`Total, frames: ${t(this,L)}, render time: ${_e(t(this,K))}`)};var A;class Ze extends Ee{constructor(){super();a(this,A);const i=[25,25,1,125,25,1,75,125,1];re([1,0,200,0,1,100,0,0,1],i),r(this,A,new Me(i))}frame(i,n){n.drawMesh(t(this,A))}}A=new WeakMap;const je="Experimental Canvas Graphics";let u=null;const tt=()=>{const[s,e]=R.useState(!0),[i,n]=R.useState(!0),h=R.useRef(null),d=R.useRef(null);R.useEffect(()=>{document.title=je},[]),R.useLayoutEffect(()=>{u=new Qe(d.current),u.start(),u.drawExample();let ae=1,he=0;const Re=2e3;u.render((l,p)=>(he>=Re?(he=0,ae*=-1):(he+=l,p.translateCameraBy([-4*ae,-4*ae,1])),!0));const xe=(l,p=performance.now(),de=0)=>{const we=new Ye(p),Se=[];for(let ce=0;ce<l+de;ce++)ce>=de?Se.push(we.rnd()):we.rnd();return Se},be=2**32,le=128,Ie=xe(le,Math.random()*be),$e=xe(le,Math.random()*be),[ke,ze]=[20,250],[Ke,Le]=[600,150];let g=null,ge=[];for(let l=0;l<le;l++)g={x:Ie[l],y:$e[l]},g.x=Ke*g.x,g.y=Le*g.y,g.x=ke+g.x,g.y=ze+g.y,ge.push(g.x,g.y,1);const Oe=new Me(ge);u.render((l,p)=>(p.drawPoints(Oe),!0)),u.render((l,p)=>(p.drawVector([128,128,1,128,256,1]),!0));let oe=0;const Ue=3e3,ye=Te("Hello, 2D Canvas!",0,0);u.render(ye),u.render(((l,p,de)=>(oe>=Ue?(oe=0,l.setPosition(Math.random()*(d.current.width-150),Math.random()*(d.current.height-100))):oe+=p,!0)).bind(null,ye));const ee=4,te=20,ve=l=>{l.altKey||l.ctrlKey||l.metaKey||(l.code==="ArrowLeft"&&u.translateCameraBy([1*(l.shiftKey?te:ee),0,1]),l.code==="ArrowRight"&&u.translateCameraBy([-1*(l.shiftKey?te:ee),0,1]),l.code==="ArrowUp"&&u.translateCameraBy([0,-1*(l.shiftKey?te:ee),1]),l.code==="ArrowDown"&&u.translateCameraBy([0,1*(l.shiftKey?te:ee),1]),l.code==="Enter"&&console.log("enter pressed"))},Ne=new ResizeObserver(l=>{const p=l[0].contentRect;u&&u.onResize(p.width,p.height)});return Ne.observe(h.current),document.body.addEventListener("keydown",ve),()=>{u&&(u.stop(),u=null),Ne.unobserve(h.current),document.body.removeEventListener("keydown",ve)}},[]);const b="my-2 mx-1 px-2 py-1 bg-blue-500 text-xl text-white rounded-md hover:bg-blue-600 active:bg-blue-700 disabled:bg-neutral-400",O=i?"fixed inset-0 w-screen h-screen":"flex-1 self-stretch border-2 border-gray-700";let pe=m.jsxDEV(m.Fragment,{children:[m.jsxDEV(qe,{className:b,appid:"default",children:"Main App"},void 0,!1,{fileName:"/apps/user-friendly.dev/src/Standalone/Graphics/Graphics.jsx",lineNumber:181,columnNumber:3},void 0),i?m.jsxDEV("button",{className:b,onClick:()=>n(!1),children:"Exit Fullscreen ⬇"},void 0,!1,{fileName:"/apps/user-friendly.dev/src/Standalone/Graphics/Graphics.jsx",lineNumber:183,columnNumber:17},void 0):m.jsxDEV("button",{className:b,onClick:()=>n(!0),children:"Fullscreen ↕"},void 0,!1,{fileName:"/apps/user-friendly.dev/src/Standalone/Graphics/Graphics.jsx",lineNumber:184,columnNumber:6},void 0),s?m.jsxDEV("button",{className:b,onClick:()=>{e(!s),u.pause()},children:"Pause ⏸"},void 0,!1,{fileName:"/apps/user-friendly.dev/src/Standalone/Graphics/Graphics.jsx",lineNumber:186,columnNumber:12},void 0):m.jsxDEV("button",{className:b,onClick:()=>{e(!s),u.start()},children:"Play ▶"},void 0,!1,{fileName:"/apps/user-friendly.dev/src/Standalone/Graphics/Graphics.jsx",lineNumber:187,columnNumber:6},void 0),m.jsxDEV("button",{className:b,onClick:()=>{u.stop()},children:"Stop ⏹"},void 0,!1,{fileName:"/apps/user-friendly.dev/src/Standalone/Graphics/Graphics.jsx",lineNumber:189,columnNumber:3},void 0)]},void 0,!0,{fileName:"/apps/user-friendly.dev/src/Standalone/Graphics/Graphics.jsx",lineNumber:180,columnNumber:21},void 0);return m.jsxDEV(Xe,{children:m.jsxDEV("div",{className:"h-full flex flex-col items-center",children:[m.jsxDEV("h2",{className:"m-4 text-4xl text-center",children:je},void 0,!1,{fileName:"/apps/user-friendly.dev/src/Standalone/Graphics/Graphics.jsx",lineNumber:194,columnNumber:4},void 0),m.jsxDEV("div",{className:"mb-4 text-3xl",children:pe},void 0,!1,{fileName:"/apps/user-friendly.dev/src/Standalone/Graphics/Graphics.jsx",lineNumber:195,columnNumber:4},void 0),m.jsxDEV("div",{ref:h,className:O,children:[m.jsxDEV("canvas",{ref:d,className:i?" absolute inset-0":null},void 0,!1,{fileName:"/apps/user-friendly.dev/src/Standalone/Graphics/Graphics.jsx",lineNumber:199,columnNumber:5},void 0),i?m.jsxDEV("div",{className:"absolute top-1 right-1",children:pe},void 0,!1,{fileName:"/apps/user-friendly.dev/src/Standalone/Graphics/Graphics.jsx",lineNumber:201,columnNumber:6},void 0):null]},void 0,!0,{fileName:"/apps/user-friendly.dev/src/Standalone/Graphics/Graphics.jsx",lineNumber:198,columnNumber:4},void 0)]},void 0,!0,{fileName:"/apps/user-friendly.dev/src/Standalone/Graphics/Graphics.jsx",lineNumber:193,columnNumber:3},void 0)},void 0,!1,{fileName:"/apps/user-friendly.dev/src/Standalone/Graphics/Graphics.jsx",lineNumber:192,columnNumber:10},void 0)};export{tt as default};
