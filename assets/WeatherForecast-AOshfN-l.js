import{r as c,j as e,S as g}from"./index-DZxVDkqq.js";import{_ as u}from"./services-Bu_7CigI.js";const N=1e3,v="https://api.weather.gov/points",h=[{id:"NY1",name:"Manhattan, NY",point:[40.7814,-73.9693]},{id:"CA1",name:"San Francisco, CA",point:[37.7922546,-122.393647]}];async function D(o){u.isArray(o)&&(o=o.join(","));try{const t=await fetch(`${v}/${o}`);if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const r=await t.json();if(!u.has(r,"properties.forecast"))throw new Error("response error, forecast endpoint not found");return r.properties.forecast}catch(t){return console.error(`failed to get forecast endpoint: ${t}`),!1}}async function E(o){let t=null;try{const s=await fetch(o);if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);if(t=await s.json(),!u.has(t,"properties.periods")||!u.isArray(t.properties.periods))throw new Error("response error, periods not found")}catch(s){return console.error(`failed to get daily forcast: ${s}`),!1}let r=t.properties.periods;r[0].isDaytime||(r=[u.clone(r[0]),...r.slice(0,-1)],r[0].isDaytime=!0);let i=1e3;return u.reduce(r,(s,n,p)=>(n.isDaytime?s.push({key:i++,name:n.name,icon:n.icon,tempDay:n.temperature,tempNight:null,tempUnit:n.temperatureUnit,rainProb:n.probabilityOfPrecipitation.value}):s[s.length-1].tempNight=n.temperature,s),[])}const k=({name:o,icon:t,tempDay:r,tempNight:i,tempUnit:s,rainProb:n})=>e.jsxs("div",{className:`
		m-2 p-4 w-44 rounded-lg border border-neutral-300 bg-white
		flex flex-col items-center
	`,children:[e.jsx("span",{className:"break-all hyphens-auto text-center text-xl text-neutral-600",children:o}),e.jsx("img",{className:"my-3 w-20 rounded-full",src:t}),e.jsxs("div",{className:"w-24 flex justify-between",children:[e.jsxs("span",{className:"",children:[r,"Â°",s]}),e.jsxs("span",{className:"text-neutral-400",children:[i,"Â°",s]})]})]}),C=o=>{const[t,r]=c.useState(!0),[i,s]=c.useState("NY1"),[n,p]=c.useState([]),[x,f]=c.useState(null),w=async a=>{const l=await D(a);if(!l){f(!0);return}const m=await E(l);if(!m){f(!0);return}p(m),r(!1),f(!1)},y=()=>{const a=h.find(l=>l.id===i);w(a.point)};c.useEffect(()=>{if(!t)return;const a=setTimeout(y,N);return()=>{clearTimeout(a)}},[i,t]);const j=a=>{s(a.target.value),r(!0)},b=a=>{r(!0)};let d=null;return x?d=e.jsx(e.Fragment,{children:"Could not get forecast. Please, try again later."}):t?d=e.jsx(g,{bg:"bg-white",borderColor:"border-blue-400",extra:"m-auto mt-4 text-center text-blue-400",children:"^"}):d=n.map((a,l)=>c.createElement(k,{...a,key:a.key})),e.jsxs("div",{className:"flex flex-col items-center min-w-80",children:[e.jsxs("div",{className:"py-8 text-xl",children:[e.jsx("select",{className:"mr-2 p-1 border border-neutral-300 rounded-md outline-neutral-600",value:i,onChange:j,children:h.map((a,l)=>e.jsx("option",{value:a.id,children:a.name},l))}),e.jsx("button",{onClick:b,children:"ðŸ”ƒ"})]}),e.jsx("div",{className:"w-full max-w-3xl flex flex-wrap justify-center",children:d}),e.jsxs("div",{className:"my-4 text-sm text-neutral-400",children:["Forecast provided by"," ",e.jsx("a",{href:"https://www.weather.gov/",target:"_blank",children:e.jsx("img",{className:"inline rounded-full w-12",src:"/nws-logo.png"})})]})]})};export{C as default};
