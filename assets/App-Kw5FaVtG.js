import{r,j as e,L as h,u as k,a as Y,R as q,b as v,A as z,B as Q}from"./index-BO2-Cufa.js";import{_ as m,t as H,f as P}from"./services-Dx03o7LF.js";const W="https://user-friendly.dev/learning-api/demos/capstone/",X="browser-mock-api-key",O=async(s,t,n={},a=null)=>{m.isObject(n)||(n={});const o={method:s,credentials:"same-origin",headers:{...n,Authorization:`Bearer ${X}`,"Content-Type":"application/json",Accept:"application/json"}};a&&(o.body=JSON.stringify(a));let l=!1;try{l=await(await fetch(W+t,o)).json()}catch(i){console.error("failed to get resource",i)}return l},Z=(s=!1,t=null)=>({error:s,message:t}),C=s=>{const t=Z();return m.isObject(s)?(s.error?(t.error=!0,t.message=s.error):s.message?t.message=s.message:t.message="Success",{...s,...t}):t},ee="Capstone-Session",$="capstone_session_token",se=s=>{try{return localStorage.setItem($,JSON.stringify(s)),!0}catch(t){console.error(t)}return!1},te=()=>{try{return JSON.parse(localStorage.getItem($))}catch{M()}return!1},M=()=>localStorage.removeItem($),ne=async s=>{try{const t=JSON.stringify(s),n=await O("GET","plants",{[ee]:t});return C(n)}catch{console.error("Failed to get plants list.")}return!1},ae=async(s,t,n)=>{const a=await O("POST","users",null,{username:s,password:t,password_confirm:n});return C(a)},re=async(s,t)=>{const n=await O("POST","users/session",null,{username:s,password:t}),a=C(n);return m.isString(n.capstone_session_token)&&(a.payload=JSON.parse(n.capstone_session_token)),a},oe=async s=>{const t=await O("DELETE","users/session",null,s);return C(t)},f=r.createContext(!1),y=s=>r.useContext(f).isActive()===!s.not?s.children:null,le=`
	p-2 rounded-lg bg-emerald-100 select-none cursor-pointer
	hover:bg-emerald-200 active:bg-emerald-300 text-emerald-700
`,u=s=>{if(s.name===void 0)return e.jsx(e.Fragment,{});const t=s.name,n=s.className,a=m.omit(m.clone(s),["name","className"]);return e.jsx("span",{className:"material-symbols-outlined "+H(le,n),...a,children:t})},G=({linkstyle:s})=>e.jsx(y,{children:e.jsx(h,{className:s,to:"/plants",children:"Plant List"})}),J="py-2 px-1 font-lato font-medium hover:text-emerald-200 active:translate-y-0.5",ie=`${J} hover:underline`,w=`
	bg-transparent text-white
	hover:bg-emerald-700 group-hover:bg-emerald-700 active:bg-emerald-600 group-active:bg-emerald-600
`,ce=`${w} rounded-full animate-spin`,I=`${J} relative group flex items-center`,L="px-1 group-hover:underline",de=`${w}`,me=()=>{const s=k(),t=r.useContext(f),[n,a]=r.useState(!1),o=async l=>{l.stopPropagation(),!n&&(a(!0),await t.signOut()&&s("/"),a(!1))};return e.jsx("div",{className:"hidden sm:flex justify-center bg-emerald-800",children:e.jsxs("div",{className:"w-full max-w-5xl flex p-8 justify-end items-center text-white",children:[e.jsx("div",{className:"flex-1 flex",children:e.jsxs(h,{to:"/",className:"p-2 flex justify-start items-center",children:[e.jsx("img",{className:"w-10",title:"brand logo",src:"https://static-task-assets.react-formula.com/capstone_logo_light.png"}),e.jsx("span",{className:"ml-4 font-playfair text-2xl",children:"Rica's Plants"})]})}),e.jsx(G,{linkstyle:ie}),e.jsxs(y,{children:[e.jsxs(h,{className:I,children:[e.jsx("span",{className:L,children:m.get(t,"data.username")}),e.jsx(u,{name:"account_circle",className:de})]}),e.jsxs(h,{onClick:o,className:I,children:[e.jsx("span",{className:L,children:"Sign Out"}),n&&e.jsx(u,{name:"progress_activity",className:ce})||e.jsx(u,{name:"logout",className:w})]})]}),e.jsx(y,{not:!0,children:e.jsxs(h,{className:I,to:"/sign-in",children:[e.jsx("span",{className:L,children:"Sign In"}),e.jsx(u,{name:"login",className:w})]})})]})})},ue=`
	w-8 h-8 animate-spin rounded-full 
	border-4 border-green-600 border-t-white
`,E=s=>{const t=s.className,n=m.omit(m.clone(s),["name","className","children"]);return e.jsx("div",{...n,className:H(ue,t),children:s.children})},S=`
	my-1 py-2 px-3 bg-emerald-200 rounded-lg
	text-center font-lato font-medium text-emerald-800 hover:text-emerald-300 hover:bg-emerald-600
`,xe="self-end bg-emerald-800 text-emerald-200 hover:text-emerald-300 hover:bg-emerald-600",ge="self-end bg-emerald-200 text-emerald-800 hover:text-emerald-300 hover:bg-emerald-600",he=`w-6 h-6 absolute top-2 right-2.5
	border-transparent border-t-emerald-800 group-hover:border-t-emerald-300
`,fe=()=>{const s=k(),t=r.useContext(f),n=r.useRef(),[a,o]=r.useState(!1),[l,i]=r.useState(!1),c=x=>{o(l)};r.useEffect(()=>{const x=j=>{n.current&&!n.current.contains(j.target)&&c()};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[l]);const d=a?e.jsx(u,{name:"close",className:ge,onClick:x=>o(l)}):e.jsx(u,{name:"menu",className:xe,onClick:x=>o(!0)}),g=async x=>{x.stopPropagation(),!l&&(i(!0),await t.signOut()&&s("/"),i(!1),o(!1))};return e.jsxs("div",{ref:n,className:P("sm:hidden fixed top-2 right-2 w-40 p-2 flex flex-col justify-center",a&&"bg-emerald-800 rounded-lg shadow-lg"),children:[d,e.jsxs("div",{className:"flex flex-col justify-center "+(a?null:"hidden"),onClick:c,children:[e.jsx(h,{className:S,to:"/",children:"Home"}),e.jsx(G,{linkstyle:S}),e.jsx(y,{children:e.jsxs("button",{onClick:g,className:S+"relative group",to:"/sign-out",children:["Sign Out",l&&e.jsx(E,{className:he})]})}),e.jsx(y,{not:!0,children:e.jsx(h,{className:S,to:"/sign-in",children:"Sign In"})})]})]})},_=()=>e.jsxs(e.Fragment,{children:[e.jsx(fe,{}),e.jsx(me,{})]}),pe=()=>e.jsxs("div",{className:"h-screen bg-rose-50 flex flex-col",children:[e.jsx(_,{}),e.jsxs("div",{className:"pt-36 flex flex-col justify-center items-center",children:[e.jsxs("h1",{className:"my-3 px-3 text-4xl text-center",children:["Error 404: ",e.jsx("br",{className:"sm:hidden"})," Page Not Found"]}),e.jsx("p",{className:"py-3 px-8 max-w-xl",children:"The page you requested was not found. Please, contact the webadmin if this is a real issue. You might also be a snowflake if you contact the webadmin."})]})]}),je=!1,N=s=>{const t=r.useContext(f),n=k(),a=s.path!==void 0?s.path:"/",o=s.delay!==void 0?s.delay:je;return r.useEffect(()=>{if(t.isActive()===!s.not)if(o!==!1){const l=setTimeout(()=>n(a),o);return()=>clearTimeout(l)}else n(a)},[t.data]),s.children},be=()=>e.jsxs(N,{not:!0,path:"/sign-in",children:[e.jsx(N,{path:"/plants"}),e.jsxs("div",{className:"min-h-screen",children:[e.jsx(_,{}),e.jsxs("div",{children:["[UNDER CONSTRUCTION]",e.jsx("br",{}),"[HOME PAGE]"]})]})]}),ve=()=>e.jsxs(e.Fragment,{children:[e.jsx(_,{}),e.jsxs("div",{className:"p-6 m-auto max-w-5xl ",children:[e.jsx("h1",{className:"my-4 text-5xl",children:"Heading"}),e.jsx("div",{className:"my-4 text-xl font-playfair",children:"Font Playfair Display test. This here is some random text to test the given font."}),e.jsx("div",{className:"my-4 text-xl font-lato",children:"Font Lato test. This here is some random text to test the given font."}),e.jsxs("div",{children:[e.jsx("h2",{className:"my-4 text-4xl",children:"Icons"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx(u,{name:"menu"}),e.jsx(u,{name:"home",className:"text-4xl"}),e.jsx(u,{name:"account_circle"}),e.jsx(u,{name:"login"}),e.jsx(u,{name:"progress_activity",className:"rounded-full bg-transparent text-amber-700 hover:bg-amber-200 active:bg-amber-300 animate-spin"}),e.jsx(u,{name:"logout"}),e.jsx(u,{name:"close",className:"bg-violet-100 text-violet-700 hover:bg-violet-200 active:bg-violet-300"})]})]})]})]}),F={text:"p-1 px-2 rounded-lg border border-slate-300 text-slate-600 bg-slate-50 focus:outline-emerald-600",button:"py-2 cursor-pointer rounded-lg text-white bg-green-800 hover:bg-green-700 active:bg-green-600",submit:"py-2 cursor-pointer rounded-lg text-white bg-green-800 hover:bg-green-700 active:bg-green-600"},R={text:"ml-3 mb-2 -mt-2 text-slate-400",button:"hidden"},ye=({name:s,value:t,type:n="text",label:a,placeholder:o="",onChange:l,isButton:i=!1,onClick:c})=>{const d=r.useId(),g=F[n]!==void 0?F[n]:F.text,x=R[n]!==void 0?R[n]:R.text;return e.jsxs("div",{className:"my-3 flex flex-col",children:[a&&e.jsx("label",{className:x,htmlFor:d,children:a}),i?e.jsx("button",{className:g,type:n,name:s,id:d,onClick:c,children:t}):e.jsx("input",{className:g,type:n,name:s,id:d,placeholder:o,value:t,onChange:l})]})},Ne=`
	m-4 pt-2 pb-4 px-8 bg-white border rounded-lg border-slate-300 font-lato font-medium
	min-w-80 flex flex-col 
`,Se=s=>{for(const t of s)if(t.name===void 0)throw"Form fields MUST have names."},we=s=>{const t={};for(const n of s)t[n.name]=n.value!==void 0?n.value:"";return t},ke=(s,t,n)=>({...s,[t]:n}),V=s=>{Se(s.fields);const t=r.useId(),[n,a]=r.useState(()=>we(s.fields)),o=i=>{i.preventDefault(),s.onSubmit(n,t,i)},l=m.assign(m.omit(s,["fields"]),{className:Ne,name:`form-${t}`,method:"POST",action:"",onSubmit:o});return e.jsxs("form",{...l,children:[s.fields.map((i,c)=>e.jsx(ye,{onChange:d=>a(ke(n,i.name,d.target.value)),...i,value:i.isButton?i.value:n[i.name]},c)),l.children]})},K=s=>{const t=s.children,n=s.status?s.status:{error:!1,message:null};return n.error!==!1&&!n.message&&(n.message="Something went wrong - try again later"),e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"relative hidden md:block",children:[e.jsx("img",{className:"h-screen object-cover",title:"plants on a rack",src:"https://static-task-assets.react-formula.com/capstone_sign_in_scene.png"}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-black/10"}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-emerald-800/40"})]}),e.jsxs("div",{className:"h-screen flex-1 bg-emerald-50 flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"flex flex-col items-center mx-2 my-8",children:[e.jsx("img",{className:"w-16 mb-2 ",title:"brand logo",src:"https://static-task-assets.react-formula.com/capstone_logo_dark.png"}),e.jsx("div",{className:"font-playfair text-emerald-700 text-2xl",children:"Rica's Plants"})]}),n.message?e.jsx("div",{className:P("animate-slideDown py-1 px-2 rounded-lg border",n.error?"bg-red-100 border-red-600 text-red-600 font-medium":"text-emerald-800 bg-emerald-100 border-emerald-600"),children:n.message}):null,t]})]})},Oe=1500,B=()=>({error:!1,message:null}),Ce=()=>{const s=r.useContext(f),t=Y(),[n,a]=r.useState(!1),[o,l]=r.useState(!1),[i,c]=r.useState(()=>m.has(t,"state.status.message")?t.state.status:B()),d=async(j,p,A)=>{if(o||s.isActive())return;console.log(`Sing up form {${p}} submitted.`),console.log("Values:",j),l(!0),c(B());const b=await re(j.username,j.password);b.error===!1&&m.isObject(b.payload)&&(console.log("Login successful. Login details:",b.payload),s.signIn(b.payload),a(Oe)),c({error:b.error,message:b.message}),l(!1)},g=e.jsx("span",{className:"flex justify-center",children:e.jsxs("span",{className:"relative",children:["Sign In ",o?e.jsx(E,{className:"absolute top-0 -right-8 ml-2 w-6 h-6 border-transparent border-t-white"}):null]})}),x=[{name:"username",label:"username",value:m.has(t,"state.username")?t.state.username:void 0,type:"text"},{name:"password",label:"password",type:"password"},{name:"submit_button",value:g,type:"submit",isButton:!0}];return e.jsx(N,{path:"/plants",delay:n,children:e.jsxs(K,{status:i,children:[e.jsx(V,{onSubmit:d,fields:x}),e.jsx(h,{to:"/sign-up",className:"text-sm text-green-700 underline hover:text-green-500",children:"Create an Account"})]})})},D=()=>({error:!1,message:null}),Ee=()=>{const s=r.useContext(f),t=k(),[n,a]=r.useState(!1),[o,l]=r.useState(()=>D()),i=async(g,x,j)=>{if(n||s.isActive())return;console.log(`Sing up form {${x}} submitted.`),console.log("Values:",g),a(!0),l(D());const p=await ae(g.username,g.password,g.password_confirm);if(p.error===!1){const A=m.clone(p);A.message="You can login with Your username & password",p.message=e.jsxs(e.Fragment,{children:[p.message,e.jsx("br",{}),"Redirecting You to Sing In page..."]}),setTimeout(()=>t("/sign-in",{state:{status:A,username:g.username}}),1500)}l(p),a(!1)},d=[{label:"username",name:"username",type:"text"},{label:"password",name:"password",type:"password"},{label:"confirm password",name:"password_confirm",type:"password"},{name:"submit_button",value:e.jsx("span",{className:"flex justify-center",children:e.jsxs("span",{className:"relative",children:["Create an Account ",n?e.jsx(E,{className:"absolute top-0 -right-8 ml-2 w-6 h-6 border-transparent border-t-white"}):null]})}),type:"submit",isButton:!0}];return e.jsx(N,{path:"/plants",children:e.jsxs(K,{status:o,children:[e.jsx(V,{onSubmit:i,fields:d}),e.jsx(h,{to:"/sign-in",className:"text-sm text-green-700 underline hover:text-green-500",children:"Log into Account"})]})})},_e=()=>{const s=r.useContext(f),[t,n]=r.useState(null),[a,o]=r.useState({error:!1}),l=async()=>{n(null);const c=await ne(s==null?void 0:s.data);c.error===!1?n(c.data):console.error("Failed to get plants list. Response:",c),o(c)};r.useEffect(()=>{l()},[s.data]);const i=c=>{const{data:d}=c;return e.jsxs("div",{className:"my-4 p-3 border rounded-lg",children:[e.jsx("div",{children:d.name}),e.jsx("img",{className:"my-4 max-w-48 object-cover rounded-md",alt:d.description,src:d.image}),e.jsx("div",{children:d.description})]})};return e.jsxs(N,{not:!0,path:"/sign-in",children:[e.jsx(_,{}),e.jsxs("div",{className:"py-12 flex flex-col justify-center items-center",children:[(a==null?void 0:a.error)!==!1&&e.jsx("div",{className:"mb-8 px-2 py-1 bg-rose-100 border border-rose-300 rounded-lg text-red-600 font-medium",children:a.message}),e.jsxs("div",{children:[t&&t.map((c,d)=>e.jsx(i,{data:c},d))||(a==null?void 0:a.error)===!1&&e.jsx(E,{}),e.jsx("br",{}),e.jsx("button",{onClick:l,className:"px-2 py-1 border rounded-md bg-emerald-50",children:"Refresh"})]})]})]})},Ae=()=>(Y(),e.jsxs(q,{children:[e.jsx(v,{path:"/",element:e.jsx(be,{})}),e.jsx(v,{path:"/sign-in",element:e.jsx(Ce,{})}),e.jsx(v,{path:"/sign-up",element:e.jsx(Ee,{})}),e.jsx(v,{path:"/style-guide",element:e.jsx(ve,{})}),e.jsx(v,{path:"/plants",element:e.jsx(_e,{})}),e.jsx(v,{path:"*",element:e.jsx(pe,{})})]})),T=`
	my-1 py-2 px-3 bg-sky-200 rounded-lg
	text-center font-lato font-medium text-sky-800 hover:text-sky-300 hover:bg-sky-600
`,U="self-end bg-sky-200 text-sky-800 hover:text-sky-300 hover:bg-sky-600",Ie=()=>{const s=r.useRef(),[t,n]=r.useState(!1);r.useEffect(()=>{const o=l=>{s.current&&!s.current.contains(l.target)&&n(!1)};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[]);const a=t?e.jsx(u,{name:"close",className:U,onClick:o=>n(!1)}):e.jsx(u,{name:"menu",className:U,onClick:o=>n(!0)});return e.jsxs("div",{ref:s,className:P("fixed bottom-2 right-2 w-40 p-2 flex flex-col-reverse justify-center",t&&"bg-sky-100 rounded-lg shadow-lg"),children:[a,e.jsxs("div",{className:"flex flex-col justify-center "+(t?null:"hidden"),onClick:()=>n(!1),children:[e.jsx(z,{className:T,appid:"default",children:"Main App"}),e.jsx(h,{className:T,to:"/style-guide",children:"Style Guide"}),e.jsx(h,{className:T,to:"/",children:"Rica's Plants"})]})]})},Le="text-emerald-600",Te=()=>{const[s,t]=r.useState(()=>te()),n={data:s,isActive:()=>m.isObject(s),signIn:a=>{t(a),se(a)},signOut:async()=>{let a=!1;return m.isObject(s)?(console.log(`Sign out user {${s.username}}.`),a=await oe(s)):console.log("No user was signed in."),t(null),M(),a}};return e.jsx(f.Provider,{value:n,children:e.jsxs(Q,{children:[e.jsx("div",{className:`${Le}`,children:e.jsx(Ae,{})}),e.jsx(Ie,{})]})})};export{Te as default};
