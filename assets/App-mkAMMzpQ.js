import{r as l,j as e,L as g,u as N,a as $,R as V,b,A as J,B as G}from"./index-JOpILubz.js";import{_ as u,t as D,f as E}from"./services-Dx03o7LF.js";const K="https://user-friendly.dev/learning-api/demos/capstone/",q="browser-mock-api-key",A=async(s,t,n=null)=>{const a={method:s,credentials:"same-origin",headers:{Authorization:`Bearer ${q}`,"Content-Type":"application/json"}};n&&(a.body=JSON.stringify(n));let r=!1;try{r=await(await fetch(K+t,a)).json()}catch(o){console.error("failed to get resource",o)}return r},F="capstone_session_token",z=s=>{try{return localStorage.setItem(F,JSON.stringify(s)),!0}catch(t){console.error(t)}return!1},Q=()=>{try{return JSON.parse(localStorage.getItem(F))}catch{U()}return!1},U=()=>localStorage.removeItem(F),W=(s=!1,t=null)=>({error:s,message:t}),I=s=>{const t=W();return u.isObject(s)&&(s.error?(t.error=!0,t.message=s.error):s.message?t.message=s.message:t.message="Success"),t},X=async(s,t,n)=>{const a=await A("POST","users",{username:s,password:t,password_confirm:n});return I(a)},Z=async(s,t)=>{const n=await A("POST","users/session",{username:s,password:t}),a=I(n);return u.isString(n.capstone_session_token)&&(a.payload=JSON.parse(n.capstone_session_token)),a},ee=async s=>{const t=await A("DELETE","users/session",s);return I(t)},v=l.createContext(!1),se=`
	p-2 rounded-lg bg-emerald-100 select-none cursor-pointer
	hover:bg-emerald-200 active:bg-emerald-300 text-emerald-700
`,d=s=>{if(s.name===void 0)return e.jsx(e.Fragment,{});const t=s.name,n=s.className,a=u.omit(u.clone(s),["name","className"]);return e.jsx("span",{className:"material-symbols-outlined "+D(se,n),...a,children:t})},Y=({linkstyle:s})=>e.jsx(e.Fragment,{children:e.jsx(g,{className:s,to:"/plants",children:"Plant List"})}),te="p-2 font-lato font-medium hover:text-emerald-200 hover:underline active:translate-y-0.5",R="mx-1",_="bg-transparent text-white hover:bg-emerald-700 active:bg-emerald-600",ne=`${_} rounded-full animate-spin`,ae=()=>{const s=N(),t=l.useContext(v),[n,a]=l.useState(!1),r=async i=>{i.stopPropagation(),!n&&(a(!0),await t.signOut()&&s("/"),a(!1))},o=e.jsx(g,{onClick:r,className:R+" relative group",children:n&&e.jsx(d,{name:"progress_activity",className:ne})||e.jsx(d,{name:"logout",className:_})});return e.jsx("div",{className:"hidden sm:flex justify-center bg-emerald-800",children:e.jsxs("div",{className:"w-full max-w-5xl flex p-8 justify-end items-center text-white",children:[e.jsx("div",{className:"flex-1",children:e.jsxs(g,{to:"/",className:"flex justify-start items-center",children:[e.jsx("img",{className:"w-10",title:"brand logo",src:"https://static-task-assets.react-formula.com/capstone_logo_light.png"}),e.jsx("span",{className:"ml-8 font-playfair text-2xl",children:"Rica's Plants"})]})}),e.jsx(Y,{linkstyle:te}),t.isActive()&&o,!t.isActive()&&e.jsx(g,{className:R,to:"/sign-in",children:e.jsx(d,{name:"login",className:_})})]})})},re=`
	w-8 h-8 animate-spin rounded-full 
	border-4 border-green-600 border-t-white
`,L=s=>{const t=s.className,n=u.omit(u.clone(s),["name","className","children"]);return e.jsx("div",{...n,className:D(re,t),children:s.children})},y=`
	my-1 py-2 px-3 bg-emerald-200 rounded-lg
	text-center font-lato font-medium text-emerald-800 hover:text-emerald-300 hover:bg-emerald-600
`,oe="self-end bg-emerald-800 text-emerald-200 hover:text-emerald-300 hover:bg-emerald-600",le="self-end bg-emerald-200 text-emerald-800 hover:text-emerald-300 hover:bg-emerald-600",ie=`w-6 h-6 absolute top-2 right-2.5
	border-transparent border-t-emerald-800 group-hover:border-t-emerald-300
`,ce=()=>{const s=N(),t=l.useContext(v),n=l.useRef(),[a,r]=l.useState(!1),[o,i]=l.useState(!1),x=c=>{r(o)};l.useEffect(()=>{const c=j=>{n.current&&!n.current.contains(j.target)&&x()};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[o]);const m=a?e.jsx(d,{name:"close",className:le,onClick:c=>r(o)}):e.jsx(d,{name:"menu",className:oe,onClick:c=>r(!0)}),h=async c=>{c.stopPropagation(),!o&&(i(!0),await t.signOut()&&s("/"),i(!1),r(!1))},f=e.jsxs("button",{onClick:h,className:y+"relative group",to:"/sign-out",children:["Sign Out",o&&e.jsx(L,{className:ie})]});return e.jsxs("div",{ref:n,className:E("sm:hidden fixed top-2 right-2 w-40 p-2 flex flex-col justify-center",a&&"bg-emerald-800 rounded-lg shadow-lg"),children:[m,e.jsxs("div",{className:"flex flex-col justify-center "+(a?null:"hidden"),onClick:x,children:[e.jsx(g,{className:y,to:"/",children:"Home"}),e.jsx(Y,{linkstyle:y}),t.isActive()&&f,!t.isActive()&&e.jsx(g,{className:y,to:"/sign-in",children:"Sign In"})]})]})},S=()=>e.jsxs(e.Fragment,{children:[e.jsx(ce,{}),e.jsx(ae,{})]}),me=()=>e.jsxs("div",{className:"h-screen bg-rose-50 flex flex-col",children:[e.jsx(S,{}),e.jsxs("div",{className:"pt-36 flex flex-col justify-center items-center",children:[e.jsxs("h1",{className:"my-3 px-3 text-4xl text-center",children:["Error 404: ",e.jsx("br",{className:"sm:hidden"})," Page Not Found"]}),e.jsx("p",{className:"py-3 px-8 max-w-xl",children:"The page you requested was not found. Please, contact the webadmin if this is a real issue. You might also be a snowflake if you contact the webadmin."})]})]}),de=!1,w=s=>{const t=l.useContext(v),n=N(),a=s.path!==void 0?s.path:"/",r=s.delay!==void 0?s.delay:de;return l.useEffect(()=>{if(t.isActive()===!s.not)if(r!==!1){const o=setTimeout(()=>n(a),r);return()=>clearTimeout(o)}else n(a)},[t.data]),s.children},ue=()=>e.jsx(w,{not:!0,path:"/sign-in",children:e.jsxs("div",{className:"min-h-screen",children:[e.jsx(S,{}),e.jsxs("div",{children:["[UNDER CONSTRUCTION]",e.jsx("br",{}),"[HOME PAGE]"]})]})}),xe=()=>e.jsxs(e.Fragment,{children:[e.jsx(S,{}),e.jsxs("div",{className:"p-6 w-[2000px] m-auto",children:[e.jsx("h1",{className:"my-4 text-5xl",children:"Heading"}),e.jsx("div",{className:"my-4 text-xl font-playfair",children:"Font Playfair Display test. This here is some random text to test the given font."}),e.jsx("div",{className:"my-4 text-xl font-lato",children:"Font Lato test. This here is some random text to test the given font."}),e.jsxs("div",{children:[e.jsx("h2",{className:"my-4 text-4xl",children:"Icons"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx(d,{name:"menu"}),e.jsx(d,{name:"home",className:"text-4xl"}),e.jsx(d,{name:"account_circle"}),e.jsx(d,{name:"login"}),e.jsx(d,{name:"progress_activity",className:"rounded-full bg-transparent text-amber-700 hover:bg-amber-200 active:bg-amber-300 animate-spin"}),e.jsx(d,{name:"logout"}),e.jsx(d,{name:"close",className:"bg-violet-100 text-violet-700 hover:bg-violet-200 active:bg-violet-300"})]})]})]})]}),k={text:"p-1 px-2 rounded-lg border border-slate-300 text-slate-600 bg-slate-50 focus:outline-emerald-600",button:"py-2 cursor-pointer rounded-lg text-white bg-green-800 hover:bg-green-700 active:bg-green-600",submit:"py-2 cursor-pointer rounded-lg text-white bg-green-800 hover:bg-green-700 active:bg-green-600"},O={text:"ml-3 mb-2 -mt-2 text-slate-400",button:"hidden"},ge=({name:s,value:t,type:n="text",label:a,placeholder:r="",onChange:o,isButton:i=!1,onClick:x})=>{const m=l.useId(),h=k[n]!==void 0?k[n]:k.text,f=O[n]!==void 0?O[n]:O.text;return e.jsxs("div",{className:"my-3 flex flex-col",children:[a&&e.jsx("label",{className:f,htmlFor:m,children:a}),i?e.jsx("button",{className:h,type:n,name:s,id:m,onClick:x,children:t}):e.jsx("input",{className:h,type:n,name:s,id:m,placeholder:r,value:t,onChange:o})]})},he=`
	m-4 pt-2 pb-4 px-8 bg-white border rounded-lg border-slate-300 font-lato font-medium
	min-w-80 flex flex-col 
`,fe=s=>{for(const t of s)if(t.name===void 0)throw"Form fields MUST have names."},je=s=>{const t={};for(const n of s)t[n.name]=n.value!==void 0?n.value:"";return t},pe=(s,t,n)=>({...s,[t]:n}),H=s=>{fe(s.fields);const t=l.useId(),[n,a]=l.useState(()=>je(s.fields)),r=i=>{i.preventDefault(),s.onSubmit(n,t,i)},o=u.assign(u.omit(s,["fields"]),{className:he,name:`form-${t}`,method:"POST",action:"",onSubmit:r});return e.jsxs("form",{...o,children:[s.fields.map((i,x)=>e.jsx(ge,{onChange:m=>a(pe(n,i.name,m.target.value)),...i,value:i.isButton?i.value:n[i.name]},x)),o.children]})},M=s=>{const t=s.children,n=s.status?s.status:{error:!1,message:null};return n.error!==!1&&!n.message&&(n.message="Something went wrong - try again later"),e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"relative hidden md:block",children:[e.jsx("img",{className:"h-screen object-cover",title:"plants on a rack",src:"https://static-task-assets.react-formula.com/capstone_sign_in_scene.png"}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-black/10"}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-emerald-800/40"})]}),e.jsxs("div",{className:"h-screen flex-1 bg-emerald-50 flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"flex flex-col items-center mx-2 my-8",children:[e.jsx("img",{className:"w-16 mb-2 ",title:"brand logo",src:"https://static-task-assets.react-formula.com/capstone_logo_dark.png"}),e.jsx("div",{className:"font-playfair text-emerald-700 text-2xl",children:"Rica's Plants"})]}),n.message?e.jsx("div",{className:E("animate-slideDown py-1 px-2 rounded-lg border",n.error?"bg-red-100 border-red-600 text-red-600 font-medium":"text-emerald-800 bg-emerald-100 border-emerald-600"),children:n.message}):null,t]})]})},be=1500,P=()=>({error:!1,message:null}),ve=()=>{const s=l.useContext(v),t=$(),[n,a]=l.useState(!1),[r,o]=l.useState(!1),[i,x]=l.useState(()=>u.has(t,"state.status.message")?t.state.status:P()),m=async(c,j,Oe)=>{if(r)return;console.log(`Sing up form {${j}} submitted.`),console.log("Values:",c),o(!0),x(P());const p=await Z(c.username,c.password);p.error===!1&&u.isObject(p.payload)&&(console.log("Login successful. Login details:",p.payload),s.signIn(p.payload),a(be)),x({error:p.error,message:p.message}),o(!1)},h=e.jsx("span",{className:"flex justify-center",children:e.jsxs("span",{className:"relative",children:["Sign In ",r?e.jsx(L,{className:"absolute top-0 -right-8 ml-2 w-6 h-6 border-transparent border-t-white"}):null]})}),f=[{name:"username",label:"username",value:u.has(t,"state.username")?t.state.username:void 0,type:"text"},{name:"password",label:"password",type:"password"},{name:"submit_button",value:h,type:"submit",isButton:!0}];return e.jsx(w,{path:"/plants",delay:n,children:e.jsxs(M,{status:i,children:[e.jsx(H,{onSubmit:m,fields:f}),e.jsx(g,{to:"/sign-up",className:"text-sm text-green-700 underline hover:text-green-500",children:"Create an Account"})]})})},T=()=>({error:!1,message:null}),ye=()=>{l.useContext(v);const s=N(),[t,n]=l.useState(!1),[a,r]=l.useState(()=>T()),o=async(m,h,f)=>{if(t)return;console.log(`Sing up form {${h}} submitted.`),console.log("Values:",m),n(!0),r(T());const c=await X(m.username,m.password,m.password_confirm);if(c.error===!1){const j=u.clone(c);j.message="You can login with Your username & password",c.message=e.jsxs(e.Fragment,{children:[c.message,e.jsx("br",{}),"Redirecting You to Sing In page..."]}),setTimeout(()=>s("/sign-in",{state:{status:j,username:m.username}}),1500)}r(c),n(!1)},x=[{label:"username",name:"username",type:"text"},{label:"password",name:"password",type:"password"},{label:"confirm password",name:"password_confirm",type:"password"},{name:"submit_button",value:e.jsx("span",{className:"flex justify-center",children:e.jsxs("span",{className:"relative",children:["Create an Account ",t?e.jsx(L,{className:"absolute top-0 -right-8 ml-2 w-6 h-6 border-transparent border-t-white"}):null]})}),type:"submit",isButton:!0}];return e.jsx(w,{path:"/plants",children:e.jsxs(M,{status:a,children:[e.jsx(H,{onSubmit:o,fields:x}),e.jsx(g,{to:"/sign-in",className:"text-sm text-green-700 underline hover:text-green-500",children:"Log into Account"})]})})},Ne=()=>e.jsxs(w,{not:!0,path:"/sign-in",children:[e.jsx(S,{}),e.jsx("div",{className:"h-screen flex flex-col justify-center items-center",children:"Plant List"})]}),Se=()=>($(),e.jsxs(V,{children:[e.jsx(b,{path:"/",element:e.jsx(ue,{})}),e.jsx(b,{path:"/sign-in",element:e.jsx(ve,{})}),e.jsx(b,{path:"/sign-up",element:e.jsx(ye,{})}),e.jsx(b,{path:"/style-guide",element:e.jsx(xe,{})}),e.jsx(b,{path:"/plants",element:e.jsx(Ne,{})}),e.jsx(b,{path:"*",element:e.jsx(me,{})})]})),C=`
	my-1 py-2 px-3 bg-sky-200 rounded-lg
	text-center font-lato font-medium text-sky-800 hover:text-sky-300 hover:bg-sky-600
`,B="self-end bg-sky-200 text-sky-800 hover:text-sky-300 hover:bg-sky-600",we=()=>{const s=l.useRef(),[t,n]=l.useState(!1);l.useEffect(()=>{const r=o=>{s.current&&!s.current.contains(o.target)&&n(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[]);const a=t?e.jsx(d,{name:"close",className:B,onClick:r=>n(!1)}):e.jsx(d,{name:"menu",className:B,onClick:r=>n(!0)});return e.jsxs("div",{ref:s,className:E("fixed bottom-2 right-2 w-40 p-2 flex flex-col-reverse justify-center",t&&"bg-sky-100 rounded-lg shadow-lg"),children:[a,e.jsxs("div",{className:"flex flex-col justify-center "+(t?null:"hidden"),onClick:()=>n(!1),children:[e.jsx(J,{className:C,appid:"default",children:"Main App"}),e.jsx(g,{className:C,to:"/style-guide",children:"Style Guide"}),e.jsx(g,{className:C,to:"/",children:"Rica's Plants"})]})]})},ke="text-emerald-600",Ee=()=>{const[s,t]=l.useState(()=>Q()),n={data:s,isActive:()=>u.isObject(s),signIn:a=>{t(a),z(a)},signOut:async()=>{let a=!1;return u.isObject(s)?(console.log(`Sign out user {${s.username}}.`),a=await ee(s)):console.log("No user was signed in."),t(null),U(),a}};return e.jsx(v.Provider,{value:n,children:e.jsxs(G,{children:[e.jsx("div",{className:`${ke}`,children:e.jsx(Se,{})}),e.jsx(we,{})]})})};export{Ee as default};
