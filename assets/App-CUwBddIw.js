import{r as l,j as e,u as w,L as S,a as L,R as D,b as p,A as U,B as Y}from"./index-dl2VAGSE.js";import{_ as c,t as R,f as P}from"./services-Dx03o7LF.js";const M="https://user-friendly.dev/learning-api/demos/capstone/",V="browser-mock-api-key",k=async(s,t,n=null)=>{const a={method:s,credentials:"same-origin",headers:{Authorization:`Bearer ${V}`,"Content-Type":"application/json"}};n&&(a.body=JSON.stringify(n));let i=!1;try{i=await(await fetch(M+t,a)).json()}catch(r){console.error("failed to get resource",r)}return i},O="capstone_session_token",J=s=>{try{return localStorage.setItem(O,JSON.stringify(s)),!0}catch(t){console.error(t)}return!1},K=()=>{try{return JSON.parse(localStorage.getItem(O))}catch{T()}return!1},T=()=>localStorage.removeItem(O),q=(s=!1,t=null)=>({error:s,message:t}),_=s=>{const t=q();return c.isObject(s)&&(s.error?(t.error=!0,t.message=s.error):s.message?t.message=s.message:t.message="Success"),t},z=async(s,t,n)=>{const a=await k("POST","users",{username:s,password:t,password_confirm:n});return _(a)},G=async(s,t)=>{const n=await k("POST","users/session",{username:s,password:t}),a=_(n);return c.isString(n.capstone_session_token)&&(a.payload=JSON.parse(n.capstone_session_token)),a},H=async s=>{const t=await k("DELETE","users/session",s);return _(t)},y=l.createContext(!1),Q=()=>e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Error 404: Page Not Found."}),e.jsx("p",{children:"The page you requested was not found. Please, contact the webadmin if this is a real issue. You might also be a snowflake if you contact the webadmin."})]}),W=`
	p-2 rounded-lg bg-green-100 select-none cursor-pointer
	hover:bg-green-200 text-green-700
`,b=s=>{if(s.name===void 0)return e.jsx(e.Fragment,{});const t=s.name,n=s.className,a=c.omit(c.clone(s),["name","className"]);return e.jsx("span",{className:"material-symbols-outlined "+R(W,n),...a,children:t})},v={text:"p-1 px-2 rounded-lg border border-slate-300 text-slate-600 bg-slate-50 focus:outline-emerald-600",button:"py-2 cursor-pointer rounded-lg text-white bg-green-800 hover:bg-green-700 active:bg-green-600",submit:"py-2 cursor-pointer rounded-lg text-white bg-green-800 hover:bg-green-700 active:bg-green-600"},N={text:"ml-3 mb-2 -mt-2 text-slate-400",button:"hidden"},X=({name:s,value:t,type:n="text",label:a,placeholder:i="",onChange:r,isButton:o=!1,onClick:g})=>{const m=l.useId(),u=v[n]!==void 0?v[n]:v.text,x=N[n]!==void 0?N[n]:N.text;return e.jsxs("div",{className:"my-3 flex flex-col",children:[a&&e.jsx("label",{className:x,htmlFor:m,children:a}),o?e.jsx("button",{className:u,type:n,name:s,id:m,onClick:g,children:t}):e.jsx("input",{className:u,type:n,name:s,id:m,placeholder:i,value:t,onChange:r})]})},Z=`
	m-4 pt-2 pb-4 px-8 bg-white border rounded-lg border-slate-300 font-lato font-medium
	min-w-80 flex flex-col 
`,ee=s=>{for(const t of s)if(t.name===void 0)throw"Form fields MUST have names."},se=s=>{const t={};for(const n of s)t[n.name]=n.value!==void 0?n.value:"";return t},te=(s,t,n)=>({...s,[t]:n}),B=s=>{ee(s.fields);const t=l.useId(),[n,a]=l.useState(()=>se(s.fields)),i=o=>{o.preventDefault(),s.onSubmit(n,t,o)},r=c.assign(c.omit(s,["fields"]),{className:Z,name:`form-${t}`,method:"POST",action:"",onSubmit:i});return e.jsxs("form",{...r,children:[s.fields.map((o,g)=>e.jsx(X,{onChange:m=>a(te(n,o.name,m.target.value)),...o,value:o.isButton?o.value:n[o.name]},g)),r.children]})},$=s=>{const t=s.children,n=s.status?s.status:{error:!1,message:null};return n.error!==!1&&!n.message&&(n.message="Something went wrong - try again later"),e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"relative hidden md:block",children:[e.jsx("img",{className:"h-screen object-cover",title:"plants on a rack",src:"https://static-task-assets.react-formula.com/capstone_sign_in_scene.png"}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-black/10"}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-green-800/40"})]}),e.jsxs("div",{className:"h-screen flex-1 bg-green-50 flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"flex flex-col items-center mx-2 my-8",children:[e.jsx("img",{className:"w-16 mb-2 ",title:"brand logo",src:"https://static-task-assets.react-formula.com/capstone_logo_dark.png"}),e.jsx("div",{className:"font-playfair text-emerald-700 text-2xl",children:"Rica's Plants"})]}),n.message?e.jsx("div",{className:P("animate-slideDown py-1 px-2 rounded-lg border",n.error?"bg-red-100 border-red-600 text-red-600 font-medium":"text-green-800 bg-green-100 border-green-600"),children:n.message}):null,t]})]})},ne=`
	w-8 h-8 animate-spin rounded-full 
	border-4 border-green-600 border-t-white
`,I=s=>{const t=s.className,n=c.omit(c.clone(s),["name","className","children"]);return e.jsx("div",{...n,className:R(ne,t),children:s.children})},A=()=>({error:!1,message:null}),ae=()=>{const s=l.useContext(y),t=w(),[n,a]=l.useState(!1),[i,r]=l.useState(()=>A());l.useEffect(()=>{s.isActive()&&(console.log(`User is already logged in as {${s.getData().username}}. Redirect to homepage.`),t("/style-guide"))},[]);const o=async(u,x,d)=>{if(n)return;console.log(`Sing up form {${x}} submitted.`),console.log("Values:",u),a(!0),r(A());const h=await z(u.username,u.password,u.password_confirm);if(h.error===!1){const f=c.clone(h);f.message="You can login with Your username & password",h.message=e.jsxs(e.Fragment,{children:[h.message,e.jsx("br",{}),"Redirecting You to Sing In page..."]}),setTimeout(()=>t("/sign-in",{state:{status:f,username:u.username}}),1e3)}r(h),a(!1)},m=[{label:"username",name:"username",type:"text"},{label:"password",name:"password",type:"password"},{label:"confirm password",name:"password_confirm",type:"password"},{name:"submit_button",value:e.jsx("span",{className:"flex justify-center",children:e.jsxs("span",{className:"relative",children:["Create an Account ",n?e.jsx(I,{className:"absolute top-0 -right-8 ml-2 w-6 h-6 border-transparent border-t-white"}):null]})}),type:"submit",isButton:!0}];return e.jsxs($,{status:i,children:[e.jsx(B,{onSubmit:o,fields:m}),e.jsx(S,{to:"/sign-in",className:"text-sm text-green-700 underline hover:text-green-500",children:"Log into Account"})]})},F=()=>({error:!1,message:null}),C=()=>{const s=l.useContext(y),t=L(),n=w(),[a,i]=l.useState(!1),[r,o]=l.useState(()=>c.has(t,"state.status.message")?t.state.status:F());l.useEffect(()=>{s.isActive()&&(console.log(`User is already logged in as {${s.getData().username}}. Redirect to homepage.`),n("/style-guide"))},[]);const g=async(x,d,h)=>{if(a)return;console.log(`Sing up form {${d}} submitted.`),console.log("Values:",x),i(!0),o(F());const f=await G(x.username,x.password);f.error===!1&&c.isObject(f.payload)&&(console.log("Login successful. Login details:",f.payload),s.signIn(f.payload),n("/style-guide")),o({error:f.error,message:f.message}),i(!1)},m=e.jsx("span",{className:"flex justify-center",children:e.jsxs("span",{className:"relative",children:["Sign In ",a?e.jsx(I,{className:"absolute top-0 -right-8 ml-2 w-6 h-6 border-transparent border-t-white"}):null]})}),u=[{name:"username",label:"username",value:c.has(t,"state.username")?t.state.username:void 0,type:"text"},{name:"password",label:"password",type:"password"},{name:"submit_button",value:m,type:"submit",isButton:!0}];return e.jsxs($,{status:r,children:[e.jsx(B,{onSubmit:g,fields:u}),e.jsx(S,{to:"/sign-up",className:"text-sm text-green-700 underline hover:text-green-500",children:"Create an Account"})]})},re=()=>e.jsxs("div",{className:"p-6 max-w-lg m-auto",children:[e.jsx("h1",{className:"my-4 text-5xl",children:"Heading"}),e.jsx("div",{className:"my-4 text-xl font-playfair",children:"Font Playfair Display test. This here is some random text to test the given font."}),e.jsx("div",{className:"my-4 text-xl font-lato",children:"Font Lato test. This here is some random text to test the given font."}),e.jsxs("div",{children:[e.jsx("h2",{className:"my-4 text-4xl",children:"Icons"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(b,{name:"menu"}),e.jsx(b,{name:"home",className:"text-4xl"}),e.jsx(b,{name:"close",className:"bg-violet-100 text-violet-700 hover:bg-violet-200"})]})]})]}),oe=()=>(L(),e.jsxs(D,{children:[e.jsx(p,{path:"/",element:e.jsx(C,{})}),e.jsx(p,{path:"/sign-in",element:e.jsx(C,{})}),e.jsx(p,{path:"/sign-up",element:e.jsx(ae,{})}),e.jsx(p,{path:"/style-guide",element:e.jsx(re,{})}),e.jsx(p,{path:"*",element:e.jsx(Q,{})})]})),j=`
	my-1 py-2 px-3 bg-sky-200 rounded-lg
	text-center font-lato font-medium text-sky-800 hover:text-sky-300 hover:bg-sky-600
`,E="self-end bg-sky-200 text-sky-800 hover:text-sky-300 hover:bg-sky-600",le=`w-6 h-6 absolute top-2 right-2.5
	border-transparent border-t-sky-800 group-hover:border-t-sky-300
`,ie=()=>{const s=w(),t=l.useContext(y),n=l.useRef(),[a,i]=l.useState(!1),[r,o]=l.useState(!1),g=d=>{i(r)};l.useEffect(()=>{const d=h=>{n.current&&!n.current.contains(h.target)&&g()};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[r]);const m=a?e.jsx(b,{name:"close",className:E,onClick:d=>i(r)}):e.jsx(b,{name:"menu",className:E,onClick:d=>i(!0)}),u=async d=>{d.stopPropagation(),!r&&(o(!0),await t.signOut()&&s("/"),o(!1),i(!1))},x=e.jsxs("button",{onClick:u,className:j+"relative group",to:"/sign-out",children:["Sign Out",r&&e.jsx(I,{className:le})]});return e.jsxs("div",{ref:n,className:P("fixed top-2 right-2 w-40 p-2 flex flex-col justify-center",a&&"bg-sky-100 rounded-lg shadow-lg"),children:[m,e.jsxs("div",{className:"flex flex-col justify-center "+(a?null:"hidden"),onClick:g,children:[e.jsx(U,{className:j,appid:"default",children:"Main App"}),e.jsx(S,{className:j,to:"/",children:"Rica's Plants"}),t.isActive()&&x,!t.isActive()&&e.jsx(S,{className:j,to:"/sign-in",children:"Sign In"})]})]})},ce="text-green-600",de=()=>{const[s,t]=l.useState(()=>K()),n={isActive:()=>c.isObject(s),getData:()=>s,signIn:a=>{t(a),J(a)},signOut:async()=>{let a=!1;return c.isObject(s)?(console.log(`Sign out user {${s.username}}.`),a=await H(s)):console.log("No user was signed in."),t(null),T(),a}};return e.jsx(y.Provider,{value:n,children:e.jsxs(Y,{children:[e.jsx("div",{className:`${ce}`,children:e.jsx(oe,{})}),e.jsx(ie,{})]})})};export{de as default};
