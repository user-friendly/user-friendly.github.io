var St=Object.defineProperty;var ot=e=>{throw TypeError(e)};var Ft=(e,t,r)=>t in e?St(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var v=(e,t,r)=>Ft(e,typeof t!="symbol"?t+"":t,r),Q=(e,t,r)=>t.has(e)||ot("Cannot "+r);var s=(e,t,r)=>(Q(e,t,"read from private field"),r?r.call(e):t.get(e)),n=(e,t,r)=>t.has(e)?ot("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),i=(e,t,r,h)=>(Q(e,t,"write to private field"),h?h.call(e,r):t.set(e,r),r),b=(e,t,r)=>(Q(e,t,"access private method"),r);import{r as V,j as c,M as Dt,L as Pt}from"./index-DWiJCoAD.js";import{_ as jt}from"./services-C3bE939n.js";const Mt=(e,t)=>{if(typeof t=="number")return e.forEach((r,h,o)=>o[h]=r*t),e;if(t.length===3)return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2],e[3]*t[0]+e[4]*t[1]+e[5]*t[2],e[6]*t[0]+e[7]*t[1]+e[8]*t[2]];if(t.length/3==3)return[e[0]*t[0]+e[1]*t[3]+e[2]*t[6],e[0]*t[1]+e[1]*t[4]+e[2]*t[7],e[0]*t[2]+e[1]*t[5]+e[2]*t[8],e[3]*t[0]+e[4]*t[3]+e[5]*t[6],e[3]*t[1]+e[4]*t[4]+e[5]*t[7],e[3]*t[2]+e[4]*t[5]+e[5]*t[8],e[6]*t[0]+e[7]*t[3]+e[8]*t[6],e[6]*t[1]+e[7]*t[4]+e[8]*t[7],e[6]*t[2]+e[7]*t[5]+e[8]*t[8]];throw"Invalid array length."};function Nt(e){e=Math.abs(parseInt(e));const t=Math.floor(e/36e5),r=Math.floor(e%36e5/6e4),h=Math.floor(e%6e4/1e3),o=e%1e3;return`${t}h ${r}m ${h}s ${o}ms`}var G,X;class lt{constructor(){n(this,G,0);n(this,X,0)}step(t){return i(this,G,s(this,G)+t),i(this,X,s(this,X)+1),this}get(){return s(this,G)/s(this,X)}}G=new WeakMap,X=new WeakMap;var E,Y,_,q,I,$;class Rt{constructor(t,r,h,o,p){n(this,E);n(this,Y);n(this,_);n(this,q);n(this,I,"30px Tiny5");n(this,$,"black");i(this,E,!0),i(this,Y,typeof t=="function"?t:()=>t),i(this,_,r),i(this,q,h),i(this,I,o!==void 0?o:s(this,I)),i(this,$,p!==void 0?p:s(this,$))}render(t,r,h){return t.font=s(this,I),t.fillStyle=s(this,$),t.fillText(s(this,Y).call(this),s(this,_),s(this,q)),s(this,E)}remove(){i(this,E,!1)}}E=new WeakMap,Y=new WeakMap,_=new WeakMap,q=new WeakMap,I=new WeakMap,$=new WeakMap;const Ct=(e,t,r,h,o)=>new Rt(e,t,r,h,o),ut=2*Math.PI;var a,F,y,D,P,H,g,j,M,w,N,k,L,O,T,R,S,U,C,l,Z,ct,dt,ft,A,pt;class zt{constructor(t=null){n(this,l);n(this,a);n(this,F);n(this,y);n(this,D);n(this,P);n(this,H);n(this,g);n(this,j);n(this,M,!0);n(this,w);n(this,N);n(this,k);n(this,L);n(this,O);n(this,T);n(this,R);n(this,S);n(this,U);n(this,C);i(this,a,t),i(this,F,s(this,a).getContext("2d")),b(this,l,Z).call(this)}start(){return console.log("Start render engine."),i(this,D,!0),i(this,w,new lt),i(this,T,0),i(this,j,performance.now()),s(this,M)&&this.showFpsDebug(),requestAnimationFrame(this.frame.bind(this)),this}pause(){return console.log("Pause render engine."),i(this,D,!1),this}stop(){return console.log("Stop render engine."),i(this,P,!0),this}frame(t){i(this,g,t-s(this,j)),i(this,j,t),s(this,M)&&b(this,l,ft).call(this),b(this,l,dt).call(this),b(this,l,ct).call(this),s(this,D)&&s(this,P)===!1?requestAnimationFrame(this.frame.bind(this)):(s(this,M)&&b(this,l,pt).call(this),s(this,P)!==!1&&b(this,l,Z).call(this))}getTransformMat(){return[1,0,0,0,-1,s(this,a).height,0,0,1]}getViewportSize(){return[s(this,a).width,s(this,a).height]}getCanvasSize(){return[s(this,a).width,s(this,a).height]}render(t){return typeof t=="object"&&typeof t.render!==void 0&&typeof t.render=="function"?s(this,y).push(t.render.bind(t)):typeof t=="function"&&s(this,y).push(t),this}drawExample(){return this.render((t,r,h)=>{t.beginPath(),t.moveTo(50,140),t.lineTo(150,60),t.lineTo(250,140),t.closePath(),t.stroke();const o=h.getCanvasSize()[0]/2,p=h.getCanvasSize()[1]/2;return t.beginPath(),t.arc(o,p,1,0,ut),t.stroke(),!0})}onResize(t,r){s(this,a).width=t,s(this,a).height=r,s(this,M)&&this.showFpsDebug()}showFpsDebug(t,r,h){this.hideFpsDebug();const o=()=>`FPS: ${s(this,C)}`,p=[s(this,a).width-125,15,1],x=Mt(this.getTransformMat(),p);this.fpsDebugTextBox=Ct(o.bind(this),x[0],x[1]),this.render(this.fpsDebugTextBox)}hideFpsDebug(){this.fpsDebugTextBox!==void 0&&this.fpsDebugTextBox.remove()}}a=new WeakMap,F=new WeakMap,y=new WeakMap,D=new WeakMap,P=new WeakMap,H=new WeakMap,g=new WeakMap,j=new WeakMap,M=new WeakMap,w=new WeakMap,N=new WeakMap,k=new WeakMap,L=new WeakMap,O=new WeakMap,T=new WeakMap,R=new WeakMap,S=new WeakMap,U=new WeakMap,C=new WeakMap,l=new WeakSet,Z=function(){i(this,y,[]),i(this,D,!1),i(this,P,!1),i(this,H,"rgb(255, 255, 255)"),i(this,g,0),i(this,j,0),i(this,w,null),i(this,k,0),i(this,L,0),i(this,N,0),i(this,O,6e4),i(this,T,0),i(this,R,0),i(this,S,0),i(this,U,5e3),i(this,C,0)},ct=function(){const t=s(this,y);i(this,y,[]);let r=null;for(;r=t.shift();)r(s(this,F),s(this,g),this)===!0&&s(this,y).push(r);return this},dt=function(){return s(this,F).fillStyle=s(this,H),s(this,F).fillRect(0,0,s(this,a).width,s(this,a).height),this},ft=function(){i(this,k,s(this,k)+s(this,g)),i(this,L,s(this,L)+1),s(this,w).step(s(this,g)),b(this,l,A).call(this),s(this,T)>s(this,O)?(i(this,N,parseInt(s(this,w).get())),i(this,T,0),i(this,w,new lt),console.log(`Average delta: ${s(this,N)} ms`)):i(this,T,s(this,T)+s(this,g))},A=function(){s(this,S)>s(this,U)?(i(this,C,parseInt(s(this,R)/s(this,S)*1e3)),i(this,R,0),i(this,S,0),console.log("FPS:",s(this,C))):(i(this,R,s(this,R)+1),i(this,S,s(this,S)+s(this,g)))},pt=function(){b(this,l,A).call(this),console.log(`Average delta: ${s(this,N)} ms`),console.log(`Total, frames: ${s(this,L)}, render time: ${Nt(s(this,k))}`)};function Et(e,t){e.beginPath(),e.arc(t.x,t.y,1,0,ut),e.stroke()}function at(e,t){e.beginPath(),e.moveTo(0,0),e.lineTo(t.x,t.y),e.closePath(),e.stroke()}const It="Graphics";let d=null;const Vt=()=>{const[e,t]=V.useState(!0),[r,h]=V.useState(!0),o=V.useRef(null),p=V.useRef(null);V.useLayoutEffect(()=>{d=new zt(p.current),d.start(),d.drawExample();const tt=(u,f=performance.now(),z=0)=>{const nt=new Dt(f),ht=[];for(let K=0;K<u+z;K++)K>=z?ht.push(nt.rnd()):nt.rnd();return ht},et=2**32,W=128,gt=tt(W,Math.random()*et),xt=tt(W,Math.random()*et),[bt,yt]=[20,250],[vt,wt]=[600,150];let m=null,st=[];for(let u=0;u<W;u++)m={x:gt[u],y:xt[u]},m.x=vt*m.x,m.y=wt*m.y,m.x=bt+m.x,m.y=yt+m.y,st.push(m);d.render((u,f)=>{for(const z of st)Et(u,z);return!0});const it={x:128,y:128},J=jt.clone(it);J.y=J.y*2,d.render((u,f)=>(at(u,it),at(u,J),!0));class Tt{constructor(){v(this,"timeout",0);v(this,"delay",3e3);v(this,"text","Hello, 2D Canvas!");v(this,"x",0);v(this,"y",0);v(this,"z",0);v(this,"w",0);this.timeout=this.delay}advance(f){this.timeout>=this.delay?(this.timeout=0,this.x=Math.random()*(p.current.width-150),this.y=Math.random()*(p.current.height-100)):this.timeout+=f}render(f,z){return this.advance(z),f.font="40px Tiny5",f.fillStyle="black",f.fillText(this.text,this.x,this.y),!0}}d.render(new Tt);const rt=new ResizeObserver(u=>{const f=u[0].contentRect;d&&d.onResize(f.width,f.height)});return rt.observe(o.current),()=>{d&&(d.stop(),d=null),rt.unobserve(o.current)}},[]);const x="my-2 mx-1 px-2 py-1 bg-blue-500 text-xl text-white rounded-md hover:bg-blue-600 active:bg-blue-700 disabled:bg-neutral-400",mt=r?"fixed inset-0 w-screen h-screen":"flex-1 self-stretch border-2 border-gray-700";let B=c.jsxs(c.Fragment,{children:[c.jsx(Pt,{className:x,to:"/home",children:"Back Home"}),r?c.jsx("button",{className:x,onClick:()=>h(!1),children:"Exit Fullscreen ⬇"}):c.jsx("button",{className:x,onClick:()=>h(!0),children:"Fullscreen ↕"}),e?c.jsx("button",{className:x,onClick:()=>{t(!e),d.pause()},children:"Pause ⏸"}):c.jsx("button",{className:x,onClick:()=>{t(!e),d.start()},children:"Play ▶"}),c.jsx("button",{className:x,onClick:()=>{d.stop()},children:"Stop ⏹"})]});return c.jsxs("div",{className:"h-full flex flex-col items-center",children:[c.jsx("h2",{className:"m-4 text-4xl text-center",children:It}),c.jsx("div",{className:"mb-4 text-3xl",children:B}),c.jsxs("div",{ref:o,className:mt,children:[c.jsx("canvas",{ref:p,className:r?" absolute inset-0":null}),r?c.jsx("div",{className:"absolute top-1 right-1",children:B}):null]})]})};export{Vt as default};
